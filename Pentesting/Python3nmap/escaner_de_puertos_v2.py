#! usr/bin/python3
# coding=utf-8

"""
A simple Python POrt Scanner with nmap
"""

import sys
import json

try:
    import nmap3
    print("Versión del módulo: " + str(nmap3.__version__))
except ModuleNotFoundError:
    print("Error import nmap, check your python3-nmap installation.")
    sys.exit(-1)

target = input("INgrese host a escanear: (eg. 192.168.211.128): ")

scanner = nmap3.Nmap()
results = scanner.scan_top_ports("127.0.0.1")
# print(results)

# json_object = json.loads(results)

json_formatted = json.dumps(results, indent = 2)

# print(json_formatted )

print("===============TOP PORTS ===============")
print(results)
print("========================================\n")

os_results = scanner.nmap_os_detection(target)

print("===============TOP PORTS ===============")
print(os_results)
print("========================================\n")

version_result = scanner.nmap_version_detection(target)
print("===============TOP PORTS ===============")
print(version_result)
print("========================================\n")

scanner = nmap3.NmapScanTechniques()
syn_scan_result = scanner.nmap_syn_scan(target)
tcp_scan_result = scanner.nmap_tcp_scan(target)
udp_scan_result = scanner.nmap_udp_scan(target)

print("=============== SYN SCAN RESULT ===============")
print(syn_scan_result)
print("========================================\n")
print("=============== TCP SCAN RESULT ===============")
print(tcp_scan_result)
print("========================================\n")
print("=============== UDP SCAN RESULT ===============")
print(udp_scan_result)
print("========================================\n")

scanner = nmap3.NmapHostDiscovery()
arp_discovery_results = scanner.nmap_arp_discovery(target)

print("=============== APP DISCOVERY RESULT ===============")
print(arp_discovery_results)
print("========================================\n")
